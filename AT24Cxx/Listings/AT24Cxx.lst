C51 COMPILER V9.60.7.0   AT24CXX                                                           12/03/2023 22:29:26 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE AT24CXX
OBJECT MODULE PLACED IN .\Objects\AT24Cxx.obj
COMPILER INVOKED BY: E:\Electrical\Application\Keil_C51\C51\BIN\C51.EXE AT24Cxx.c OPTIMIZE(8,SPEED) INCDIR(..\I2C) DEBUG
                    - OBJECTEXTEND PRINT(.\Listings\AT24Cxx.lst) TABS(2) OBJECT(.\Objects\AT24Cxx.obj)

line level    source

   1          #include "AT24Cxx.h"
   2          #include "i2c.h"
   3          
   4          void AT24Cxx_write(unsigned char device_addr, unsigned int rom_addr, unsigned char _data)
   5          {
   6   1        if (rom_addr > 0xffff)
   7   1          return;
   8   1        i2c_start_transmit(device_addr);
   9   1        i2c_transmit(rom_addr >> 8);
  10   1        i2c_transmit(rom_addr & 0x00ff);
  11   1        i2c_transmit(_data);
  12   1        i2c_stop();
  13   1      }
  14          
  15          unsigned char AT24Cxx_read(unsigned char device_addr, unsigned int rom_addr)
  16          {
  17   1        unsigned char buffer;
  18   1        if (rom_addr > 0xffff)
  19   1          return '\0';
  20   1        i2c_start_transmit(device_addr);
  21   1        i2c_transmit(rom_addr >> 8);
  22   1        i2c_transmit(rom_addr & 0x00ff);
  23   1        i2c_start_receive(device_addr);
  24   1        buffer = i2c_receive();
  25   1        i2c_nack();
  26   1        i2c_stop();
  27   1        return buffer;
  28   1      }
  29          
  30          void AT24Cxx_write_array(unsigned char device_addr, unsigned int rom_addr, unsigned char* _data, unsigned 
             -int len)
  31          {
  32   1        unsigned int i, j, next_addr;
  33   1        if (rom_addr > 0xffff)
  34   1          return;
  35   1        next_addr = rom_addr + 1;
  36   1        i2c_start_transmit(device_addr);
  37   1        i2c_transmit(rom_addr >> 8);
  38   1        i2c_transmit(rom_addr & 0x00ff);
  39   1        i2c_transmit(_data[0]);
  40   1        for (i=1; i<len; i++)
  41   1        {
  42   2          if (_data[i] == '\0')
  43   2            break;
  44   2          if ((next_addr & 0x00ff) == 0x0000)
  45   2          {
  46   3            i2c_stop();
  47   3            for (j = 0; j < 12300; j++); //delay
  48   3            i2c_start_transmit(device_addr);
  49   3            i2c_transmit(next_addr >> 8);
  50   3            i2c_transmit(next_addr & 0x00ff);
  51   3          }
  52   2          i2c_transmit(_data[i]);
  53   2          next_addr++;
C51 COMPILER V9.60.7.0   AT24CXX                                                           12/03/2023 22:29:26 PAGE 2   

  54   2        }
  55   1        i2c_stop();
  56   1      }
  57          
  58          void AT24Cxx_read_array(unsigned char device_addr, unsigned int rom_addr, unsigned char* buffer, unsigned 
             -int len)
  59          {
  60   1        unsigned int i, j;
  61   1        if (rom_addr > 0xffff)
  62   1          return;
  63   1        i2c_start_transmit(device_addr);
  64   1        i2c_transmit(rom_addr >> 8);
  65   1        i2c_transmit(rom_addr & 0x00ff);
  66   1        i2c_start_receive(device_addr);
  67   1        for (i=0; i<len-1; i++)
  68   1        {
  69   2          buffer[i] = i2c_receive();
  70   2          i2c_ack();
  71   2        }
  72   1        buffer[i] = i2c_receive();
  73   1        i2c_nack();
  74   1        i2c_stop();
  75   1      }
*** WARNING C280 IN LINE 60 OF AT24Cxx.c: 'j': unreferenced local variable


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    405    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      31
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
